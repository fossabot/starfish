(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["pages/FreeMaseTest/pages/s/index"],{

/***/ "./assets/scripts/freemase/Rect.ts":
/*!*****************************************!*\
  !*** ./assets/scripts/freemase/Rect.ts ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _classCallCheck = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n\nvar _createClass = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FreeMaseRect = void 0;\n\nvar FreeMaseRect = /*#__PURE__*/function () {\n  function FreeMaseRect(_ref) {\n    var top = _ref.top,\n        left = _ref.left,\n        bottom = _ref.bottom,\n        right = _ref.right;\n\n    _classCallCheck(this, FreeMaseRect);\n\n    this.top = top;\n    this.left = left;\n    this.bottom = bottom;\n    this.right = right;\n  }\n\n  _createClass(FreeMaseRect, [{\n    key: \"width\",\n    get: function get() {\n      return this.right - this.left;\n    }\n  }, {\n    key: \"height\",\n    get: function get() {\n      return this.bottom - this.top;\n    }\n  }]);\n\n  return FreeMaseRect;\n}();\n\nexports.FreeMaseRect = FreeMaseRect;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hc3NldHMvc2NyaXB0cy9mcmVlbWFzZS9SZWN0LnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vYXNzZXRzL3NjcmlwdHMvZnJlZW1hc2UvUmVjdC50cz85NmFjIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5GcmVlTWFzZVJlY3QgPSB2b2lkIDA7XG5jbGFzcyBGcmVlTWFzZVJlY3Qge1xuICAgIGNvbnN0cnVjdG9yKHsgdG9wLCBsZWZ0LCBib3R0b20sIHJpZ2h0LCB9KSB7XG4gICAgICAgIHRoaXMudG9wID0gdG9wO1xuICAgICAgICB0aGlzLmxlZnQgPSBsZWZ0O1xuICAgICAgICB0aGlzLmJvdHRvbSA9IGJvdHRvbTtcbiAgICAgICAgdGhpcy5yaWdodCA9IHJpZ2h0O1xuICAgIH1cbiAgICBnZXQgd2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJpZ2h0IC0gdGhpcy5sZWZ0O1xuICAgIH1cbiAgICBnZXQgaGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ib3R0b20gLSB0aGlzLnRvcDtcbiAgICB9XG59XG5leHBvcnRzLkZyZWVNYXNlUmVjdCA9IEZyZWVNYXNlUmVjdDtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFBQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBRUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./assets/scripts/freemase/Rect.ts\n");

/***/ }),

/***/ "./assets/scripts/freemase/index.ts":
/*!******************************************!*\
  !*** ./assets/scripts/freemase/index.ts ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"./node_modules/core-js/modules/es.array.slice.js\");\n\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"./node_modules/core-js/modules/es.function.name.js\");\n\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"./node_modules/core-js/modules/es.symbol.js\");\n\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"./node_modules/core-js/modules/es.symbol.description.js\");\n\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"./node_modules/core-js/modules/es.symbol.iterator.js\");\n\nvar _toConsumableArray = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/toConsumableArray.js\");\n\nvar _asyncToGenerator = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"./node_modules/@babel/runtime/helpers/asyncToGenerator.js\");\n\nvar _classCallCheck = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\");\n\nvar _createClass = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/createClass.js\");\n\n__webpack_require__(/*! regenerator-runtime/runtime.js */ \"./node_modules/regenerator-runtime/runtime.js\");\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"./node_modules/core-js/modules/es.object.to-string.js\");\n\n__webpack_require__(/*! core-js/modules/es.set.js */ \"./node_modules/core-js/modules/es.set.js\");\n\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"./node_modules/core-js/modules/es.string.iterator.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.add-all.js */ \"./node_modules/core-js/modules/esnext.set.add-all.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.delete-all.js */ \"./node_modules/core-js/modules/esnext.set.delete-all.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.difference.js */ \"./node_modules/core-js/modules/esnext.set.difference.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.every.js */ \"./node_modules/core-js/modules/esnext.set.every.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.filter.js */ \"./node_modules/core-js/modules/esnext.set.filter.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.find.js */ \"./node_modules/core-js/modules/esnext.set.find.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.intersection.js */ \"./node_modules/core-js/modules/esnext.set.intersection.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.is-disjoint-from.js */ \"./node_modules/core-js/modules/esnext.set.is-disjoint-from.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.is-subset-of.js */ \"./node_modules/core-js/modules/esnext.set.is-subset-of.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.is-superset-of.js */ \"./node_modules/core-js/modules/esnext.set.is-superset-of.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.join.js */ \"./node_modules/core-js/modules/esnext.set.join.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.map.js */ \"./node_modules/core-js/modules/esnext.set.map.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.reduce.js */ \"./node_modules/core-js/modules/esnext.set.reduce.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.some.js */ \"./node_modules/core-js/modules/esnext.set.some.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.symmetric-difference.js */ \"./node_modules/core-js/modules/esnext.set.symmetric-difference.js\");\n\n__webpack_require__(/*! core-js/modules/esnext.set.union.js */ \"./node_modules/core-js/modules/esnext.set.union.js\");\n\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"./node_modules/core-js/modules/web.dom-collections.iterator.js\");\n\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"./node_modules/core-js/modules/web.dom-collections.for-each.js\");\n\n__webpack_require__(/*! core-js/modules/es.array.filter.js */ \"./node_modules/core-js/modules/es.array.filter.js\");\n\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"./node_modules/core-js/modules/es.array.from.js\");\n\n__webpack_require__(/*! core-js/modules/es.array.find-index.js */ \"./node_modules/core-js/modules/es.array.find-index.js\");\n\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"./node_modules/core-js/modules/es.array.concat.js\");\n\n__webpack_require__(/*! core-js/modules/web.timers.js */ \"./node_modules/core-js/modules/web.timers.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Rect_1 = __webpack_require__(/*! ./Rect */ \"./assets/scripts/freemase/Rect.ts\");\n\nvar FreeMase = /*#__PURE__*/function () {\n  function FreeMase(parentEl, options) {\n    var _this = this;\n\n    _classCallCheck(this, FreeMase);\n\n    this.maxWidth = 99999;\n    this.maxHeight = 99999;\n    this.options = {};\n    this.resizeObserver = null;\n    this.mutationObserver = null;\n    this.watchingForResize = new Set();\n    this.parentEl = parentEl;\n    this.window = window;\n    this.options = options;\n\n    if (!this.parentEl) {\n      console.error(\"FreeMase requires a parent element as the first property to its constructor.\");\n      return;\n    }\n\n    if (!window) {\n      if (this.options.debug) console.error(\"FreeMase can only run in a browser (window object not found).\");\n      return;\n    }\n\n    this.window.addEventListener(\"resize\", debounce(function () {\n      _this.position();\n    }), {\n      passive: true\n    });\n    this.setup();\n  }\n\n  _createClass(FreeMase, [{\n    key: \"setup\",\n    value: function () {\n      var _setup = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        var giveUpLimit, giveUp, ready, mutateCallback, resizeCallback, _i, _Array$from, child;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                giveUpLimit = 100;\n                giveUp = 0;\n\n              case 2:\n                if (!(!this.parentEl || !this.window)) {\n                  _context.next = 10;\n                  break;\n                }\n\n                _context.next = 5;\n                return sleep(100);\n\n              case 5:\n                if (!(++giveUp > giveUpLimit)) {\n                  _context.next = 8;\n                  break;\n                }\n\n                if (this.options.debug) console.error(\"FreeMase:\", \"Failed to initialize\");\n                return _context.abrupt(\"return\");\n\n              case 8:\n                _context.next = 2;\n                break;\n\n              case 10:\n                if (!(this.resizeObserver && this.mutationObserver)) {\n                  _context.next = 12;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 12:\n                this.maxWidth = this.parentEl.offsetWidth;\n                ready = false;\n                mutateCallback = debounce(function (els) {\n                  if (!ready) return;\n                  if (els) els.forEach(function (entry) {\n                    var parentEl = entry.target;\n                    if (!parentEl) return;\n                    if (_this2.options.debug) console.log(\"FreeMase:\", \"base element mutated\"); // handle initial elements\n\n                    var _iterator = _createForOfIteratorHelper(_toConsumableArray(entry.target.childNodes).filter(function (n) {\n                      return n.nodeType === 1;\n                    })),\n                        _step;\n\n                    try {\n                      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                        var el = _step.value;\n                        if (_this2.watchingForResize.has(el)) return;\n                        if (_this2.resizeObserver) _this2.resizeObserver.observe(el);\n                        if (_this2.options.debug) console.log(\"FreeMase:\", \"now watching for resize:\", el);\n\n                        _this2.watchingForResize.add(el);\n                      } // handle added elements\n\n                    } catch (err) {\n                      _iterator.e(err);\n                    } finally {\n                      _iterator.f();\n                    }\n\n                    var _iterator2 = _createForOfIteratorHelper(_toConsumableArray(entry.addedNodes).filter(function (n) {\n                      return n.nodeType === 1;\n                    })),\n                        _step2;\n\n                    try {\n                      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                        var addedElement = _step2.value;\n                        if (_this2.watchingForResize.has(addedElement)) return;\n                        if (_this2.resizeObserver) _this2.resizeObserver.observe(addedElement);\n                        if (_this2.options.debug) console.log(\"FreeMase:\", \"now watching for resize:\", addedElement);\n\n                        _this2.watchingForResize.add(addedElement);\n                      } // handle removed elements\n\n                    } catch (err) {\n                      _iterator2.e(err);\n                    } finally {\n                      _iterator2.f();\n                    }\n\n                    var _iterator3 = _createForOfIteratorHelper(_toConsumableArray(entry.removedNodes).filter(function (n) {\n                      return n.nodeType === 1;\n                    })),\n                        _step3;\n\n                    try {\n                      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n                        var removedElement = _step3.value;\n                        if (!_this2.watchingForResize.has(removedElement)) return;\n                        if (_this2.resizeObserver) _this2.resizeObserver.unobserve(removedElement);\n                        if (_this2.options.debug) console.log(\"FreeMase:\", \"stopped watching for resize:\", removedElement);\n\n                        _this2.watchingForResize.delete(removedElement);\n                      }\n                    } catch (err) {\n                      _iterator3.e(err);\n                    } finally {\n                      _iterator3.f();\n                    }\n                  });\n\n                  _this2.position();\n                }, 100);\n                resizeCallback = debounce(function (els) {\n                  if (_this2.options.debug) console.log(\"FreeMase:\", \"resized\", els);\n                  if (!ready) return;\n\n                  _this2.position();\n                }, 100);\n                this.mutationObserver = new MutationObserver(mutateCallback);\n                this.mutationObserver.observe(this.parentEl, {\n                  childList: true\n                });\n                this.resizeObserver = new ResizeObserver(resizeCallback);\n\n                for (_i = 0, _Array$from = Array.from(this.parentEl.children); _i < _Array$from.length; _i++) {\n                  child = _Array$from[_i];\n                  if (this.options.debug) console.log(\"FreeMase:\", \"now watching for resize:\", child);\n                  this.resizeObserver.observe(child);\n                  this.watchingForResize.add(child);\n                }\n\n                ready = true;\n                this.position();\n\n              case 22:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function setup() {\n        return _setup.apply(this, arguments);\n      }\n\n      return setup;\n    }()\n  }, {\n    key: \"position\",\n    value: function () {\n      var _position = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var _this3 = this,\n            _takenSpaces$reduce;\n\n        var startTime, availableSpaces, takenSpaces, i, element, determinePlacementForOneFrame, frames, _loop2, _i5, lastTakenSpace, placeFrames, debugContainer, _iterator8, _step8, space, debugEl, elapsedTime;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(!this.parentEl || !this.resizeObserver || !this.mutationObserver)) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", 0);\n\n              case 2:\n                startTime = Date.now(); // console.log('FreeMase:', `resetting positions`)\n\n                this.parentEl.style.width = \"100%\";\n                this.maxWidth = this.parentEl.offsetWidth;\n                availableSpaces = [new Rect_1.FreeMaseRect({\n                  top: 0,\n                  left: 0,\n                  right: this.maxWidth,\n                  bottom: this.maxHeight\n                })];\n                takenSpaces = [];\n\n                for (i = 0; i < this.parentEl.children.length; i++) {\n                  element = this.parentEl.children[i];\n                  element.style.position = \"absolute\";\n                  element.style.top = \"0px\";\n                  element.style.left = \"\".concat(this.options.centerX ? this.maxWidth / 2 - element.offsetWidth / 2 : 0, \"px\");\n                }\n\n                determinePlacementForOneFrame = function determinePlacementForOneFrame(element) {\n                  var elBcr = element.getBoundingClientRect(); // const firstFitIndex = availableSpaces.findIndex(\n                  //   (space) => {\n                  //     if (elBcr.width > space.width) return false\n                  //     if (elBcr.height > space.height) return false\n                  //     return true\n                  //   },\n                  // )\n\n                  var bestFitIndex = availableSpaces.findIndex(function (space, index) {\n                    if (elBcr.width > space.width) return false;\n                    if (elBcr.height > space.height) return false;\n\n                    for (var _i2 = index + 1; _i2 < Math.min(index + 10, availableSpaces.length); _i2++) {\n                      var nextSpace = availableSpaces[_i2];\n                      if (!nextSpace) continue;\n\n                      if (nextSpace.left <= space.left && nextSpace.width >= elBcr.width && nextSpace.top - space.top < _this3.options.skipLessThanHeight) {\n                        if (availableSpaces[index - 1] && availableSpaces[index - 1].top === space.top) return true;\n                        return false;\n                      }\n                    }\n\n                    return true;\n                  });\n                  if (bestFitIndex === -1) return null;\n                  var firstFit = availableSpaces[bestFitIndex];\n                  var placedRect = new Rect_1.FreeMaseRect({\n                    top: firstFit.top,\n                    left: firstFit.left,\n                    bottom: firstFit.top + elBcr.height,\n                    right: firstFit.left + elBcr.width\n                  });\n                  takenSpaces.push(placedRect); // console.log('FreeMase:', `---`)\n                  // console.log('FreeMase:', `placing:`, element)\n                  // console.log('FreeMase:', `placing in rect`, placedRect)\n                  // recalculate available spaces\n\n                  availableSpaces = [];\n                  var doneAddingNewAvailableSpaces = false;\n                  var searchTop = 0;\n\n                  var getNewSearchTop = function getNewSearchTop(next, takenRect) {\n                    if (takenRect.bottom < next && takenRect.bottom > searchTop) return takenRect.bottom;\n                    return next;\n                  };\n\n                  while (!doneAddingNewAvailableSpaces) {\n                    var aligned = []; // raycast horizontally: find all rects that hit one horizontal line\n\n                    var _iterator4 = _createForOfIteratorHelper(takenSpaces),\n                        _step4;\n\n                    try {\n                      for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n                        var _takenRect2 = _step4.value;\n                        var verticallyAligned = searchTop >= _takenRect2.top && searchTop < _takenRect2.bottom;\n                        if (verticallyAligned) aligned.push(_takenRect2);\n                      } // if nothing found, skip to next horizontal line\n\n                    } catch (err) {\n                      _iterator4.e(err);\n                    } finally {\n                      _iterator4.f();\n                    }\n\n                    if (!aligned.length) {\n                      doneAddingNewAvailableSpaces = true;\n                      continue;\n                    } // find the gaps\n\n\n                    var foundSpans = [];\n\n                    var _loop = function _loop() {\n                      var takenRect = _aligned[_i3];\n\n                      // check left\n                      if (takenRect.left > 0) {\n                        var nextToTheLeft = aligned.reduce(function (next, otherRect) {\n                          if (otherRect === takenRect) return next;\n                          if (otherRect.right <= takenRect.left && (!next || otherRect.right > next.right)) return otherRect;\n                          return next;\n                        }, null);\n\n                        if (nextToTheLeft && nextToTheLeft.right < takenRect.left) {\n                          // there's a gap!\n                          foundSpans.push({\n                            left: nextToTheLeft.right,\n                            right: takenRect.left\n                          });\n                        } else if (!nextToTheLeft) {\n                          foundSpans.push({\n                            left: 0,\n                            right: takenRect.left\n                          });\n                        }\n                      } // check right\n\n\n                      var nextToTheRight = aligned.reduce(function (next, otherRect) {\n                        if (otherRect === takenRect) return next;\n\n                        if (otherRect.left >= takenRect.right && (!next || otherRect.left < next.left)) {\n                          return otherRect;\n                        }\n\n                        return next;\n                      }, null);\n\n                      if (nextToTheRight && nextToTheRight.left > takenRect.right) {\n                        // there's a gap!\n                        foundSpans.push({\n                          left: takenRect.right,\n                          right: nextToTheRight.left\n                        });\n                      } else if (!nextToTheRight && takenRect.right !== _this3.maxWidth) {\n                        foundSpans.push({\n                          left: takenRect.right,\n                          right: _this3.maxWidth\n                        });\n                      }\n                    };\n\n                    for (var _i3 = 0, _aligned = aligned; _i3 < _aligned.length; _i3++) {\n                      _loop();\n                    } // console.log('FreeMase:', `gaps`, foundSpans)\n                    // get the max heights for the gaps\n\n\n                    for (var _i4 = 0, _foundSpans = foundSpans; _i4 < _foundSpans.length; _i4++) {\n                      var _foundSpans$_i = _foundSpans[_i4],\n                          left = _foundSpans$_i.left,\n                          right = _foundSpans$_i.right;\n                      var top = searchTop;\n                      var bottom = _this3.maxHeight;\n                      var rectBelow = void 0;\n\n                      var _iterator5 = _createForOfIteratorHelper(takenSpaces),\n                          _step5;\n\n                      try {\n                        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n                          var _takenRect = _step5.value;\n                          if (_takenRect.left >= right || _takenRect.right <= left) continue;\n                          if (_takenRect.bottom <= top) continue;\n\n                          if (_takenRect.top < bottom) {\n                            bottom = _takenRect.top;\n                            rectBelow = _takenRect;\n                          }\n                        } // add the available space rect\n\n                      } catch (err) {\n                        _iterator5.e(err);\n                      } finally {\n                        _iterator5.f();\n                      }\n\n                      if (bottom !== top) availableSpaces.push(new Rect_1.FreeMaseRect({\n                        top: top,\n                        bottom: bottom,\n                        left: left,\n                        right: right\n                      })); // if we hit another box, there's a chance that we can find more gaps\n\n                      while (rectBelow) {\n                        // check from the right edge of the previously hit lower box\n                        var newLeft = rectBelow.right;\n                        var newBottom = _this3.maxHeight;\n                        rectBelow = undefined; // if the right edge of the lower box is beyond our rightmost limit, we're already done\n\n                        if (newLeft > right) continue;\n\n                        var _iterator6 = _createForOfIteratorHelper(takenSpaces),\n                            _step6;\n\n                        try {\n                          for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n                            var takenRect = _step6.value;\n                            if (takenRect.left >= right || takenRect.right <= newLeft) continue;\n                            if (takenRect.bottom <= top) continue;\n\n                            if (takenRect.top < newBottom) {\n                              newBottom = takenRect.top;\n                              rectBelow = takenRect;\n                            }\n                          } // add the new available space we've found\n\n                        } catch (err) {\n                          _iterator6.e(err);\n                        } finally {\n                          _iterator6.f();\n                        }\n\n                        if (newBottom !== top) {\n                          availableSpaces.push(new Rect_1.FreeMaseRect({\n                            top: top,\n                            bottom: newBottom,\n                            left: newLeft,\n                            right: right\n                          }));\n                        }\n                      }\n                    } // get new search starting horizontal line\n\n\n                    searchTop = aligned.reduce(getNewSearchTop, _this3.maxHeight);\n                    if (searchTop === _this3.maxHeight) doneAddingNewAvailableSpaces = true;\n                  } // add bottom available space\n\n\n                  var lastTakenSpace = takenSpaces.reduce(function (last, curr) {\n                    if (curr.bottom > last.bottom) return curr;\n                    return last;\n                  }, takenSpaces[0]) || {\n                    bottom: 0\n                  };\n                  availableSpaces.push(new Rect_1.FreeMaseRect({\n                    top: lastTakenSpace.bottom,\n                    bottom: _this3.maxHeight,\n                    left: 0,\n                    right: _this3.maxWidth\n                  }));\n                  return {\n                    element: element,\n                    rect: placedRect\n                  }; // console.log('FreeMase:', `available spaces:`, availableSpaces)\n                };\n\n                frames = [];\n                _loop2 = /*#__PURE__*/regeneratorRuntime.mark(function _loop2(_i5) {\n                  var element;\n                  return regeneratorRuntime.wrap(function _loop2$(_context2) {\n                    while (1) {\n                      switch (_context2.prev = _context2.next) {\n                        case 0:\n                          element = _this3.parentEl.children[_i5];\n                          _context2.next = 3;\n                          return new Promise(function (resolve) {\n                            var placement = determinePlacementForOneFrame(element);\n                            if (placement) frames.push(placement);\n                            resolve();\n                          });\n\n                        case 3:\n                        case \"end\":\n                          return _context2.stop();\n                      }\n                    }\n                  }, _loop2);\n                });\n                _i5 = 0;\n\n              case 12:\n                if (!(_i5 < this.parentEl.children.length)) {\n                  _context3.next = 17;\n                  break;\n                }\n\n                return _context3.delegateYield(_loop2(_i5), \"t0\", 14);\n\n              case 14:\n                _i5++;\n                _context3.next = 12;\n                break;\n\n              case 17:\n                lastTakenSpace = ((_takenSpaces$reduce = takenSpaces.reduce(function (last, curr) {\n                  if (curr.bottom > last.bottom) return curr;\n                  return last;\n                }, takenSpaces[0])) === null || _takenSpaces$reduce === void 0 ? void 0 : _takenSpaces$reduce.bottom) || 0;\n                this.parentEl.style.height = \"\".concat(lastTakenSpace, \"px\");\n\n                placeFrames = function placeFrames(frameData) {\n                  var offsetLeft = 0;\n\n                  if (_this3.options.centerX) {\n                    var farthestRight = frameData.reduce(function (farthest, curr) {\n                      if (curr.rect.right > farthest) return curr.rect.right;\n                      return farthest;\n                    }, 0);\n                    offsetLeft = (_this3.maxWidth - farthestRight) / 2;\n                  }\n\n                  var _iterator7 = _createForOfIteratorHelper(frameData),\n                      _step7;\n\n                  try {\n                    for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n                      var d = _step7.value;\n                      d.element.style.top = \"\".concat(d.rect.top, \"px\");\n                      d.element.style.left = \"\".concat(d.rect.left + offsetLeft, \"px\");\n                      d.element.style.opacity = \"1\";\n                    }\n                  } catch (err) {\n                    _iterator7.e(err);\n                  } finally {\n                    _iterator7.f();\n                  }\n                };\n\n                placeFrames(frames);\n\n                if (this.options.debug) {\n                  debugContainer = document.getElementById(\"freemaseDebug\");\n\n                  if (!debugContainer) {\n                    debugContainer = document.createElement(\"div\");\n                    debugContainer.id = \"freemaseDebug\";\n                    debugContainer.style.position = \"absolute\";\n                    debugContainer.style.top = \"0\";\n                    debugContainer.style.left = \"0\";\n                    debugContainer.style.height = lastTakenSpace + \"px\";\n                    debugContainer.style.zIndex = \"999999\";\n                    this.parentEl.prepend(debugContainer);\n                  } else {\n                    // clear existing elements\n                    while (debugContainer.firstChild) {\n                      debugContainer.removeChild(debugContainer.firstChild);\n                    }\n                  }\n\n                  _iterator8 = _createForOfIteratorHelper(availableSpaces);\n\n                  try {\n                    for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n                      space = _step8.value;\n                      debugEl = document.createElement(\"div\");\n                      debugEl.style.cssText = \"\\n          position: absolute;\\n          top: \".concat(space.top, \"px;\\n          left: \").concat(space.left, \"px;\\n          width: \").concat(space.width, \"px;\\n          height: \").concat(space.height, \"px;\\n          background: rgba(255, 0, 0, 0.2);\\n        \");\n                      debugContainer.appendChild(debugEl);\n                    }\n                  } catch (err) {\n                    _iterator8.e(err);\n                  } finally {\n                    _iterator8.f();\n                  }\n                }\n\n                elapsedTime = Date.now() - startTime;\n                if (this.options.debug) console.log(\"FreeMase:\", \"elapsed time: \".concat(elapsedTime));\n                return _context3.abrupt(\"return\", elapsedTime);\n\n              case 25:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function position() {\n        return _position.apply(this, arguments);\n      }\n\n      return position;\n    }()\n  }]);\n\n  return FreeMase;\n}();\n\nexports.default = FreeMase;\n\nfunction debounce(fn) {\n  var time = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 500;\n  var timeout;\n  return function () {\n    for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n      params[_key] = arguments[_key];\n    }\n\n    if (timeout) clearTimeout(timeout);\n    timeout = setTimeout(function () {\n      fn.apply(void 0, params);\n    }, time);\n  };\n}\n\nfunction sleep(ms) {\n  return new Promise(function (resolve) {\n    setTimeout(resolve, ms);\n  });\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hc3NldHMvc2NyaXB0cy9mcmVlbWFzZS9pbmRleC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2Fzc2V0cy9zY3JpcHRzL2ZyZWVtYXNlL2luZGV4LnRzP2FiNDciXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5jb25zdCBSZWN0XzEgPSByZXF1aXJlKFwiLi9SZWN0XCIpO1xuY2xhc3MgRnJlZU1hc2Uge1xuICAgIGNvbnN0cnVjdG9yKHBhcmVudEVsLCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMubWF4V2lkdGggPSA5OTk5OTtcbiAgICAgICAgdGhpcy5tYXhIZWlnaHQgPSA5OTk5OTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0ge307XG4gICAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIgPSBudWxsO1xuICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIgPSBudWxsO1xuICAgICAgICB0aGlzLndhdGNoaW5nRm9yUmVzaXplID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLnBhcmVudEVsID0gcGFyZW50RWw7XG4gICAgICAgIHRoaXMud2luZG93ID0gd2luZG93O1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50RWwpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZyZWVNYXNlIHJlcXVpcmVzIGEgcGFyZW50IGVsZW1lbnQgYXMgdGhlIGZpcnN0IHByb3BlcnR5IHRvIGl0cyBjb25zdHJ1Y3Rvci5gKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXdpbmRvdykge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kZWJ1ZylcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGcmVlTWFzZSBjYW4gb25seSBydW4gaW4gYSBicm93c2VyICh3aW5kb3cgb2JqZWN0IG5vdCBmb3VuZCkuYCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihgcmVzaXplYCwgZGVib3VuY2UoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wb3NpdGlvbigpO1xuICAgICAgICB9KSwge1xuICAgICAgICAgICAgcGFzc2l2ZTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0dXAoKTtcbiAgICB9XG4gICAgYXN5bmMgc2V0dXAoKSB7XG4gICAgICAgIGNvbnN0IGdpdmVVcExpbWl0ID0gMTAwO1xuICAgICAgICBsZXQgZ2l2ZVVwID0gMDtcbiAgICAgICAgd2hpbGUgKCF0aGlzLnBhcmVudEVsIHx8ICF0aGlzLndpbmRvdykge1xuICAgICAgICAgICAgYXdhaXQgc2xlZXAoMTAwKTtcbiAgICAgICAgICAgIGlmICgrK2dpdmVVcCA+IGdpdmVVcExpbWl0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kZWJ1ZylcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRnJlZU1hc2U6YCwgYEZhaWxlZCB0byBpbml0aWFsaXplYCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlc2l6ZU9ic2VydmVyICYmIHRoaXMubXV0YXRpb25PYnNlcnZlcilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5tYXhXaWR0aCA9IHRoaXMucGFyZW50RWwub2Zmc2V0V2lkdGg7XG4gICAgICAgIGxldCByZWFkeSA9IGZhbHNlO1xuICAgICAgICBjb25zdCBtdXRhdGVDYWxsYmFjayA9IGRlYm91bmNlKChlbHMpID0+IHtcbiAgICAgICAgICAgIGlmICghcmVhZHkpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKGVscylcbiAgICAgICAgICAgICAgICBlbHMuZm9yRWFjaCgoZW50cnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyZW50RWwgPSBlbnRyeS50YXJnZXQ7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcGFyZW50RWwpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGVidWcpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRnJlZU1hc2U6YCwgYGJhc2UgZWxlbWVudCBtdXRhdGVkYCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBpbml0aWFsIGVsZW1lbnRzXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGVsIG9mIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmVudHJ5LnRhcmdldC5jaGlsZE5vZGVzLFxuICAgICAgICAgICAgICAgICAgICBdLmZpbHRlcigobikgPT4gbi5ub2RlVHlwZSA9PT0gMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndhdGNoaW5nRm9yUmVzaXplLmhhcyhlbCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzaXplT2JzZXJ2ZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemVPYnNlcnZlci5vYnNlcnZlKGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGVidWcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEZyZWVNYXNlOmAsIGBub3cgd2F0Y2hpbmcgZm9yIHJlc2l6ZTpgLCBlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhdGNoaW5nRm9yUmVzaXplLmFkZChlbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gaGFuZGxlIGFkZGVkIGVsZW1lbnRzXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGFkZGVkRWxlbWVudCBvZiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5lbnRyeS5hZGRlZE5vZGVzLFxuICAgICAgICAgICAgICAgICAgICBdLmZpbHRlcigobikgPT4gbi5ub2RlVHlwZSA9PT0gMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndhdGNoaW5nRm9yUmVzaXplLmhhcyhhZGRlZEVsZW1lbnQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlc2l6ZU9ic2VydmVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZShhZGRlZEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kZWJ1ZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRnJlZU1hc2U6YCwgYG5vdyB3YXRjaGluZyBmb3IgcmVzaXplOmAsIGFkZGVkRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhdGNoaW5nRm9yUmVzaXplLmFkZChhZGRlZEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSByZW1vdmVkIGVsZW1lbnRzXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHJlbW92ZWRFbGVtZW50IG9mIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmVudHJ5LnJlbW92ZWROb2RlcyxcbiAgICAgICAgICAgICAgICAgICAgXS5maWx0ZXIoKG4pID0+IG4ubm9kZVR5cGUgPT09IDEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMud2F0Y2hpbmdGb3JSZXNpemUuaGFzKHJlbW92ZWRFbGVtZW50KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXNpemVPYnNlcnZlcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyLnVub2JzZXJ2ZShyZW1vdmVkRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRlYnVnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBGcmVlTWFzZTpgLCBgc3RvcHBlZCB3YXRjaGluZyBmb3IgcmVzaXplOmAsIHJlbW92ZWRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2F0Y2hpbmdGb3JSZXNpemUuZGVsZXRlKHJlbW92ZWRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5wb3NpdGlvbigpO1xuICAgICAgICB9LCAxMDApO1xuICAgICAgICBjb25zdCByZXNpemVDYWxsYmFjayA9IGRlYm91bmNlKChlbHMpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGVidWcpXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEZyZWVNYXNlOmAsIGByZXNpemVkYCwgZWxzKTtcbiAgICAgICAgICAgIGlmICghcmVhZHkpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5wb3NpdGlvbigpO1xuICAgICAgICB9LCAxMDApO1xuICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihtdXRhdGVDYWxsYmFjayk7XG4gICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKHRoaXMucGFyZW50RWwsIHtcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIocmVzaXplQ2FsbGJhY2spO1xuICAgICAgICBmb3IgKGxldCBjaGlsZCBvZiBBcnJheS5mcm9tKHRoaXMucGFyZW50RWwuY2hpbGRyZW4pKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRlYnVnKVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBGcmVlTWFzZTpgLCBgbm93IHdhdGNoaW5nIGZvciByZXNpemU6YCwgY2hpbGQpO1xuICAgICAgICAgICAgdGhpcy5yZXNpemVPYnNlcnZlci5vYnNlcnZlKGNoaWxkKTtcbiAgICAgICAgICAgIHRoaXMud2F0Y2hpbmdGb3JSZXNpemUuYWRkKGNoaWxkKTtcbiAgICAgICAgfVxuICAgICAgICByZWFkeSA9IHRydWU7XG4gICAgICAgIHRoaXMucG9zaXRpb24oKTtcbiAgICB9XG4gICAgYXN5bmMgcG9zaXRpb24oKSB7XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnRFbCB8fFxuICAgICAgICAgICAgIXRoaXMucmVzaXplT2JzZXJ2ZXIgfHxcbiAgICAgICAgICAgICF0aGlzLm11dGF0aW9uT2JzZXJ2ZXIpXG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0ZyZWVNYXNlOicsIGByZXNldHRpbmcgcG9zaXRpb25zYClcbiAgICAgICAgdGhpcy5wYXJlbnRFbC5zdHlsZS53aWR0aCA9IGAxMDAlYDtcbiAgICAgICAgdGhpcy5tYXhXaWR0aCA9IHRoaXMucGFyZW50RWwub2Zmc2V0V2lkdGg7XG4gICAgICAgIGxldCBhdmFpbGFibGVTcGFjZXMgPSBbXG4gICAgICAgICAgICBuZXcgUmVjdF8xLkZyZWVNYXNlUmVjdCh7XG4gICAgICAgICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgICAgICAgcmlnaHQ6IHRoaXMubWF4V2lkdGgsXG4gICAgICAgICAgICAgICAgYm90dG9tOiB0aGlzLm1heEhlaWdodCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICBdO1xuICAgICAgICBjb25zdCB0YWtlblNwYWNlcyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucGFyZW50RWwuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnBhcmVudEVsLmNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9IGBhYnNvbHV0ZWA7XG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRvcCA9IGAwcHhgO1xuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5sZWZ0ID0gYCR7dGhpcy5vcHRpb25zLmNlbnRlclhcbiAgICAgICAgICAgICAgICA/IHRoaXMubWF4V2lkdGggLyAyIC0gZWxlbWVudC5vZmZzZXRXaWR0aCAvIDJcbiAgICAgICAgICAgICAgICA6IDB9cHhgO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRldGVybWluZVBsYWNlbWVudEZvck9uZUZyYW1lID0gKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsQmNyID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIC8vIGNvbnN0IGZpcnN0Rml0SW5kZXggPSBhdmFpbGFibGVTcGFjZXMuZmluZEluZGV4KFxuICAgICAgICAgICAgLy8gICAoc3BhY2UpID0+IHtcbiAgICAgICAgICAgIC8vICAgICBpZiAoZWxCY3Iud2lkdGggPiBzcGFjZS53aWR0aCkgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAvLyAgICAgaWYgKGVsQmNyLmhlaWdodCA+IHNwYWNlLmhlaWdodCkgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgIC8vICAgfSxcbiAgICAgICAgICAgIC8vIClcbiAgICAgICAgICAgIGNvbnN0IGJlc3RGaXRJbmRleCA9IGF2YWlsYWJsZVNwYWNlcy5maW5kSW5kZXgoKHNwYWNlLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlbEJjci53aWR0aCA+IHNwYWNlLndpZHRoKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKGVsQmNyLmhlaWdodCA+IHNwYWNlLmhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBpbmRleCArIDE7IGkgPFxuICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihpbmRleCArIDEwLCBhdmFpbGFibGVTcGFjZXMubGVuZ3RoKTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRTcGFjZSA9IGF2YWlsYWJsZVNwYWNlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFuZXh0U3BhY2UpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRTcGFjZS5sZWZ0IDw9IHNwYWNlLmxlZnQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRTcGFjZS53aWR0aCA+PSBlbEJjci53aWR0aCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFNwYWNlLnRvcCAtIHNwYWNlLnRvcCA8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnNraXBMZXNzVGhhbkhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF2YWlsYWJsZVNwYWNlc1tpbmRleCAtIDFdICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZhaWxhYmxlU3BhY2VzW2luZGV4IC0gMV0udG9wID09PSBzcGFjZS50b3ApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChiZXN0Rml0SW5kZXggPT09IC0xKVxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgY29uc3QgZmlyc3RGaXQgPSBhdmFpbGFibGVTcGFjZXNbYmVzdEZpdEluZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IHBsYWNlZFJlY3QgPSBuZXcgUmVjdF8xLkZyZWVNYXNlUmVjdCh7XG4gICAgICAgICAgICAgICAgdG9wOiBmaXJzdEZpdC50b3AsXG4gICAgICAgICAgICAgICAgbGVmdDogZmlyc3RGaXQubGVmdCxcbiAgICAgICAgICAgICAgICBib3R0b206IGZpcnN0Rml0LnRvcCArIGVsQmNyLmhlaWdodCxcbiAgICAgICAgICAgICAgICByaWdodDogZmlyc3RGaXQubGVmdCArIGVsQmNyLndpZHRoLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0YWtlblNwYWNlcy5wdXNoKHBsYWNlZFJlY3QpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0ZyZWVNYXNlOicsIGAtLS1gKVxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0ZyZWVNYXNlOicsIGBwbGFjaW5nOmAsIGVsZW1lbnQpXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnRnJlZU1hc2U6JywgYHBsYWNpbmcgaW4gcmVjdGAsIHBsYWNlZFJlY3QpXG4gICAgICAgICAgICAvLyByZWNhbGN1bGF0ZSBhdmFpbGFibGUgc3BhY2VzXG4gICAgICAgICAgICBhdmFpbGFibGVTcGFjZXMgPSBbXTtcbiAgICAgICAgICAgIGxldCBkb25lQWRkaW5nTmV3QXZhaWxhYmxlU3BhY2VzID0gZmFsc2U7XG4gICAgICAgICAgICBsZXQgc2VhcmNoVG9wID0gMDtcbiAgICAgICAgICAgIGNvbnN0IGdldE5ld1NlYXJjaFRvcCA9IChuZXh0LCB0YWtlblJlY3QpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGFrZW5SZWN0LmJvdHRvbSA8IG5leHQgJiZcbiAgICAgICAgICAgICAgICAgICAgdGFrZW5SZWN0LmJvdHRvbSA+IHNlYXJjaFRvcClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRha2VuUmVjdC5ib3R0b207XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgd2hpbGUgKCFkb25lQWRkaW5nTmV3QXZhaWxhYmxlU3BhY2VzKSB7XG4gICAgICAgICAgICAgICAgbGV0IGFsaWduZWQgPSBbXTtcbiAgICAgICAgICAgICAgICAvLyByYXljYXN0IGhvcml6b250YWxseTogZmluZCBhbGwgcmVjdHMgdGhhdCBoaXQgb25lIGhvcml6b250YWwgbGluZVxuICAgICAgICAgICAgICAgIGZvciAobGV0IHRha2VuUmVjdCBvZiB0YWtlblNwYWNlcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2ZXJ0aWNhbGx5QWxpZ25lZCA9IHNlYXJjaFRvcCA+PSB0YWtlblJlY3QudG9wICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hUb3AgPCB0YWtlblJlY3QuYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmVydGljYWxseUFsaWduZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlnbmVkLnB1c2godGFrZW5SZWN0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gaWYgbm90aGluZyBmb3VuZCwgc2tpcCB0byBuZXh0IGhvcml6b250YWwgbGluZVxuICAgICAgICAgICAgICAgIGlmICghYWxpZ25lZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9uZUFkZGluZ05ld0F2YWlsYWJsZVNwYWNlcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBmaW5kIHRoZSBnYXBzXG4gICAgICAgICAgICAgICAgY29uc3QgZm91bmRTcGFucyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IHRha2VuUmVjdCBvZiBhbGlnbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGxlZnRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRha2VuUmVjdC5sZWZ0ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dFRvVGhlTGVmdCA9IGFsaWduZWQucmVkdWNlKChuZXh0LCBvdGhlclJlY3QpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3RoZXJSZWN0ID09PSB0YWtlblJlY3QpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvdGhlclJlY3QucmlnaHQgPD0gdGFrZW5SZWN0LmxlZnQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCFuZXh0IHx8IG90aGVyUmVjdC5yaWdodCA+IG5leHQucmlnaHQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3RoZXJSZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dFRvVGhlTGVmdCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRUb1RoZUxlZnQucmlnaHQgPCB0YWtlblJlY3QubGVmdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZXJlJ3MgYSBnYXAhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRTcGFucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogbmV4dFRvVGhlTGVmdC5yaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IHRha2VuUmVjdC5sZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIW5leHRUb1RoZUxlZnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZFNwYW5zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodDogdGFrZW5SZWN0LmxlZnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgcmlnaHRcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dFRvVGhlUmlnaHQgPSBhbGlnbmVkLnJlZHVjZSgobmV4dCwgb3RoZXJSZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3RoZXJSZWN0ID09PSB0YWtlblJlY3QpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3RoZXJSZWN0LmxlZnQgPj0gdGFrZW5SZWN0LnJpZ2h0ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKCFuZXh0IHx8IG90aGVyUmVjdC5sZWZ0IDwgbmV4dC5sZWZ0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvdGhlclJlY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgICAgICAgICAgfSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0VG9UaGVSaWdodCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFRvVGhlUmlnaHQubGVmdCA+IHRha2VuUmVjdC5yaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlcmUncyBhIGdhcCFcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kU3BhbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogdGFrZW5SZWN0LnJpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBuZXh0VG9UaGVSaWdodC5sZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIW5leHRUb1RoZVJpZ2h0ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWtlblJlY3QucmlnaHQgIT09IHRoaXMubWF4V2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kU3BhbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogdGFrZW5SZWN0LnJpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiB0aGlzLm1heFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0ZyZWVNYXNlOicsIGBnYXBzYCwgZm91bmRTcGFucylcbiAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIG1heCBoZWlnaHRzIGZvciB0aGUgZ2Fwc1xuICAgICAgICAgICAgICAgIGZvciAobGV0IHsgbGVmdCwgcmlnaHQgfSBvZiBmb3VuZFNwYW5zKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB0b3AgPSBzZWFyY2hUb3A7XG4gICAgICAgICAgICAgICAgICAgIGxldCBib3R0b20gPSB0aGlzLm1heEhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJlY3RCZWxvdztcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgdGFrZW5SZWN0IG9mIHRha2VuU3BhY2VzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFrZW5SZWN0LmxlZnQgPj0gcmlnaHQgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWtlblJlY3QucmlnaHQgPD0gbGVmdClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWtlblJlY3QuYm90dG9tIDw9IHRvcClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWtlblJlY3QudG9wIDwgYm90dG9tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0gdGFrZW5SZWN0LnRvcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWN0QmVsb3cgPSB0YWtlblJlY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIHRoZSBhdmFpbGFibGUgc3BhY2UgcmVjdFxuICAgICAgICAgICAgICAgICAgICBpZiAoYm90dG9tICE9PSB0b3ApXG4gICAgICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVTcGFjZXMucHVzaChuZXcgUmVjdF8xLkZyZWVNYXNlUmVjdCh7IHRvcCwgYm90dG9tLCBsZWZ0LCByaWdodCB9KSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHdlIGhpdCBhbm90aGVyIGJveCwgdGhlcmUncyBhIGNoYW5jZSB0aGF0IHdlIGNhbiBmaW5kIG1vcmUgZ2Fwc1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAocmVjdEJlbG93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmcm9tIHRoZSByaWdodCBlZGdlIG9mIHRoZSBwcmV2aW91c2x5IGhpdCBsb3dlciBib3hcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0xlZnQgPSByZWN0QmVsb3cucmlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3Qm90dG9tID0gdGhpcy5tYXhIZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWN0QmVsb3cgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgcmlnaHQgZWRnZSBvZiB0aGUgbG93ZXIgYm94IGlzIGJleW9uZCBvdXIgcmlnaHRtb3N0IGxpbWl0LCB3ZSdyZSBhbHJlYWR5IGRvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXdMZWZ0ID4gcmlnaHQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB0YWtlblJlY3Qgb2YgdGFrZW5TcGFjZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFrZW5SZWN0LmxlZnQgPj0gcmlnaHQgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFrZW5SZWN0LnJpZ2h0IDw9IG5ld0xlZnQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWtlblJlY3QuYm90dG9tIDw9IHRvcClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRha2VuUmVjdC50b3AgPCBuZXdCb3R0b20pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Qm90dG9tID0gdGFrZW5SZWN0LnRvcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdEJlbG93ID0gdGFrZW5SZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCB0aGUgbmV3IGF2YWlsYWJsZSBzcGFjZSB3ZSd2ZSBmb3VuZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0JvdHRvbSAhPT0gdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZhaWxhYmxlU3BhY2VzLnB1c2gobmV3IFJlY3RfMS5GcmVlTWFzZVJlY3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3AsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbTogbmV3Qm90dG9tLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBuZXdMZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZ2V0IG5ldyBzZWFyY2ggc3RhcnRpbmcgaG9yaXpvbnRhbCBsaW5lXG4gICAgICAgICAgICAgICAgc2VhcmNoVG9wID0gYWxpZ25lZC5yZWR1Y2UoZ2V0TmV3U2VhcmNoVG9wLCB0aGlzLm1heEhlaWdodCk7XG4gICAgICAgICAgICAgICAgaWYgKHNlYXJjaFRvcCA9PT0gdGhpcy5tYXhIZWlnaHQpXG4gICAgICAgICAgICAgICAgICAgIGRvbmVBZGRpbmdOZXdBdmFpbGFibGVTcGFjZXMgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gYWRkIGJvdHRvbSBhdmFpbGFibGUgc3BhY2VcbiAgICAgICAgICAgIGNvbnN0IGxhc3RUYWtlblNwYWNlID0gdGFrZW5TcGFjZXMucmVkdWNlKChsYXN0LCBjdXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnIuYm90dG9tID4gbGFzdC5ib3R0b20pXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJyO1xuICAgICAgICAgICAgICAgIHJldHVybiBsYXN0O1xuICAgICAgICAgICAgfSwgdGFrZW5TcGFjZXNbMF0pIHx8IHsgYm90dG9tOiAwIH07XG4gICAgICAgICAgICBhdmFpbGFibGVTcGFjZXMucHVzaChuZXcgUmVjdF8xLkZyZWVNYXNlUmVjdCh7XG4gICAgICAgICAgICAgICAgdG9wOiBsYXN0VGFrZW5TcGFjZS5ib3R0b20sXG4gICAgICAgICAgICAgICAgYm90dG9tOiB0aGlzLm1heEhlaWdodCxcbiAgICAgICAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgICAgICAgIHJpZ2h0OiB0aGlzLm1heFdpZHRoLFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LFxuICAgICAgICAgICAgICAgIHJlY3Q6IHBsYWNlZFJlY3QsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0ZyZWVNYXNlOicsIGBhdmFpbGFibGUgc3BhY2VzOmAsIGF2YWlsYWJsZVNwYWNlcylcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZnJhbWVzID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wYXJlbnRFbC5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMucGFyZW50RWwuY2hpbGRyZW5baV07XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBsYWNlbWVudCA9IGRldGVybWluZVBsYWNlbWVudEZvck9uZUZyYW1lKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGlmIChwbGFjZW1lbnQpXG4gICAgICAgICAgICAgICAgICAgIGZyYW1lcy5wdXNoKHBsYWNlbWVudCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGFzdFRha2VuU3BhY2UgPSB0YWtlblNwYWNlcy5yZWR1Y2UoKGxhc3QsIGN1cnIpID0+IHtcbiAgICAgICAgICAgIGlmIChjdXJyLmJvdHRvbSA+IGxhc3QuYm90dG9tKVxuICAgICAgICAgICAgICAgIHJldHVybiBjdXJyO1xuICAgICAgICAgICAgcmV0dXJuIGxhc3Q7XG4gICAgICAgIH0sIHRha2VuU3BhY2VzWzBdKT8uYm90dG9tIHx8IDA7XG4gICAgICAgIHRoaXMucGFyZW50RWwuc3R5bGUuaGVpZ2h0ID0gYCR7bGFzdFRha2VuU3BhY2V9cHhgO1xuICAgICAgICBjb25zdCBwbGFjZUZyYW1lcyA9IChmcmFtZURhdGEpID0+IHtcbiAgICAgICAgICAgIGxldCBvZmZzZXRMZWZ0ID0gMDtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY2VudGVyWCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZhcnRoZXN0UmlnaHQgPSBmcmFtZURhdGEucmVkdWNlKChmYXJ0aGVzdCwgY3VycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3Vyci5yZWN0LnJpZ2h0ID4gZmFydGhlc3QpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3Vyci5yZWN0LnJpZ2h0O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFydGhlc3Q7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICAgICAgb2Zmc2V0TGVmdCA9ICh0aGlzLm1heFdpZHRoIC0gZmFydGhlc3RSaWdodCkgLyAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgZCBvZiBmcmFtZURhdGEpIHtcbiAgICAgICAgICAgICAgICBkLmVsZW1lbnQuc3R5bGUudG9wID0gYCR7ZC5yZWN0LnRvcH1weGA7XG4gICAgICAgICAgICAgICAgZC5lbGVtZW50LnN0eWxlLmxlZnQgPSBgJHtkLnJlY3QubGVmdCArIG9mZnNldExlZnR9cHhgO1xuICAgICAgICAgICAgICAgIGQuZWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gYDFgO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBwbGFjZUZyYW1lcyhmcmFtZXMpO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRlYnVnKSB7XG4gICAgICAgICAgICBsZXQgZGVidWdDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgZnJlZW1hc2VEZWJ1Z2ApO1xuICAgICAgICAgICAgaWYgKCFkZWJ1Z0NvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIGRlYnVnQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgZGl2YCk7XG4gICAgICAgICAgICAgICAgZGVidWdDb250YWluZXIuaWQgPSBgZnJlZW1hc2VEZWJ1Z2A7XG4gICAgICAgICAgICAgICAgZGVidWdDb250YWluZXIuc3R5bGUucG9zaXRpb24gPSBgYWJzb2x1dGVgO1xuICAgICAgICAgICAgICAgIGRlYnVnQ29udGFpbmVyLnN0eWxlLnRvcCA9IGAwYDtcbiAgICAgICAgICAgICAgICBkZWJ1Z0NvbnRhaW5lci5zdHlsZS5sZWZ0ID0gYDBgO1xuICAgICAgICAgICAgICAgIGRlYnVnQ29udGFpbmVyLnN0eWxlLmhlaWdodCA9IGxhc3RUYWtlblNwYWNlICsgYHB4YDtcbiAgICAgICAgICAgICAgICBkZWJ1Z0NvbnRhaW5lci5zdHlsZS56SW5kZXggPSBgOTk5OTk5YDtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudEVsLnByZXBlbmQoZGVidWdDb250YWluZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gY2xlYXIgZXhpc3RpbmcgZWxlbWVudHNcbiAgICAgICAgICAgICAgICB3aGlsZSAoZGVidWdDb250YWluZXIuZmlyc3RDaGlsZClcbiAgICAgICAgICAgICAgICAgICAgZGVidWdDb250YWluZXIucmVtb3ZlQ2hpbGQoZGVidWdDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCBzcGFjZSBvZiBhdmFpbGFibGVTcGFjZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWJ1Z0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgZGl2YCk7XG4gICAgICAgICAgICAgICAgZGVidWdFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICB0b3A6ICR7c3BhY2UudG9wfXB4O1xuICAgICAgICAgIGxlZnQ6ICR7c3BhY2UubGVmdH1weDtcbiAgICAgICAgICB3aWR0aDogJHtzcGFjZS53aWR0aH1weDtcbiAgICAgICAgICBoZWlnaHQ6ICR7c3BhY2UuaGVpZ2h0fXB4O1xuICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAwLCAwLCAwLjIpO1xuICAgICAgICBgO1xuICAgICAgICAgICAgICAgIGRlYnVnQ29udGFpbmVyLmFwcGVuZENoaWxkKGRlYnVnRWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGVsYXBzZWRUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kZWJ1ZylcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBGcmVlTWFzZTpgLCBgZWxhcHNlZCB0aW1lOiAke2VsYXBzZWRUaW1lfWApO1xuICAgICAgICByZXR1cm4gZWxhcHNlZFRpbWU7XG4gICAgfVxufVxuZXhwb3J0cy5kZWZhdWx0ID0gRnJlZU1hc2U7XG5mdW5jdGlvbiBkZWJvdW5jZShmbiwgdGltZSA9IDUwMCkge1xuICAgIGxldCB0aW1lb3V0O1xuICAgIHJldHVybiAoLi4ucGFyYW1zKSA9PiB7XG4gICAgICAgIGlmICh0aW1lb3V0KVxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBmbiguLi5wYXJhbXMpO1xuICAgICAgICB9LCB0aW1lKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc2xlZXAobXMpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgc2V0VGltZW91dChyZXNvbHZlLCBtcyk7XG4gICAgfSk7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTs7OztBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUtBO0FBTkE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBTEE7QUFTQTtBQUFBO0FBVEE7QUFDQTtBQURBO0FBT0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbEJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBcUJBO0FBQUE7QUFyQkE7QUFDQTtBQURBO0FBbUJBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQWlDQTtBQUFBO0FBakNBO0FBQ0E7QUFEQTtBQStCQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBekNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUEwQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQXBGQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBOzs7Ozs7Ozs7O0FBb0ZBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFDQTtBQURBO0FBR0E7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBVEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQWhCQTtBQWdCQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFHQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBbEVBO0FBQ0E7QUFlQTtBQUFBO0FBbURBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQUE7QUFDQTtBQURBO0FBSUE7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQUE7QUFDQTtBQURBO0FBUUE7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5CQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFtQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUFBO0FBOU5BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWdPQTtBQWhPQTtBQUFBO0FBa09BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUF2T0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUErTkE7QUFDQTtBQWhPQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUErTkE7QUEvTkE7QUFBQTtBQUNBO0FBREE7QUF3T0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZBO0FBQUE7QUFDQTtBQURBO0FBVUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUVBO0FBQ0E7QUFqQkE7QUFDQTtBQURBO0FBaUJBO0FBQUE7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQTVCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBNkJBO0FBQ0E7QUFBQTtBQUNBO0FBOVJBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBOzs7Ozs7Ozs7Ozs7QUFrU0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./assets/scripts/freemase/index.ts\n");

/***/ })

}]);